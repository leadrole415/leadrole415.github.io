


<!DOCTYPE HTML>
<html>
	<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>다락골 초록원</title>

	<link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,700" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Playfair+Display:400,700" rel="stylesheet">
	
	<!-- Animate.css -->
	<link rel="stylesheet" href="css/animate.css">
	<!-- Icomoon Icon Fonts-->
	<link rel="stylesheet" href="css/icomoon.css">
	<!-- Bootstrap  -->
	<link rel="stylesheet" href="css/bootstrap.css">

	<!-- Magnific Popup -->
	<link rel="stylesheet" href="css/magnific-popup.css">

	<!-- Flexslider  -->
	<link rel="stylesheet" href="css/flexslider.css">

	<!-- Owl Carousel -->
	<link rel="stylesheet" href="css/owl.carousel.min.css">
	<link rel="stylesheet" href="css/owl.theme.default.min.css">
	
	<!-- Date Picker -->
	<link rel="stylesheet" href="css/bootstrap-datepicker.css">
	<!-- Flaticons  -->
	<link rel="stylesheet" href="fonts/flaticon/font/flaticon.css">

	<!-- Theme style  -->
	<link rel="stylesheet" href="css/style.css">

	<!-- Modernizr JS -->
	<script src="js/modernizr-2.6.2.min.js"></script>
	<!-- FOR IE9 below -->
	<!--[if lt IE 9]>
	<script src="js/respond.min.js"></script>
	<![endif]-->
	<!-- jQuery -->
	<script src="js/jquery.min.js"></script>
	<!-- jQuery Easing -->
	<script src="js/jquery.easing.1.3.js"></script>
	<!-- Bootstrap -->
	<script src="js/bootstrap.min.js"></script>
	<!-- Waypoints -->
	<script src="js/jquery.waypoints.min.js"></script>
	<!-- Flexslider -->
	<script src="js/jquery.flexslider-min.js"></script>
	<!-- Owl carousel -->
	<script src="js/owl.carousel.min.js"></script>
	<!-- Magnific Popup -->
	<script src="js/jquery.magnific-popup.min.js"></script>
	<script src="js/magnific-popup-options.js"></script>
	<!-- Date Picker -->
	<script src="js/bootstrap-datepicker.js"></script>
	<!-- Main -->
	<script src="js/main.js"></script>
	<style>

		.main-text{
			width:100%;
			margin:0 auto;
		}   

        body {
            margin: 0;
            padding: 0;
        }
        table{
			border-collapse: collapse;
			width:100%;
			max-width: 100%;
			text-align:center;
        }
        #wrap {
			padding: 100px 0 150px;
			clear:both;
            width: 1170px;
            /* margin: 20px auto; */
        }

        #rHeader {
            /* margin-top: 30px; */
        }

        #rTopmenu {
            list-style: none;
            /* padding-top: 100px; */
        }

        #rList {
            height: 31px;
            padding: 0px;
            margin: 0px;
            border-bottom: 1px solid silver;
        }

        #rTopmenu li {
            display: inline;
        }
       
        #rTopmenu li a{
            background: rgb(255, 255, 255);
            border-bottom: 1px solid rgb(255, 255, 255);
            text-decoration: none;
            position: relative;
            float: left;
            width: 130px;
            height: 30px;
            line-height: 30px;
            text-align: center;
            font-size: 14px;
            /* color: grey; */
            margin: 0px -1px -1px 0px;
            border-width: 1px;
            border-style: solid;
            border-color: rgb(210, 210, 210);
        }
		
		@media screen and (max-width: 480px) {
			#rTopmenu li a {
				width:80px;
			} 
		}

        .selected{
            color: black;
        }
		#select_list{
			text-align:center;
		}
        .alist{
			/* margin:0 auto; */
			width: 1170px;
			border-collapse: collapse;
        }
        .alist input{
            border-style:none;
			text-align:center;
			height: inherit;
        }
        #stitle{
            text-align: left;
            margin: 30px 0 10px;
        }
        #myForm {
            padding-top: 30px;
            clear: both;
        }

        .blist {
            width: 1170px;
            border-collapse: collapse;
            /* border-collapse:separate;
            border-spacing: 2px;
            border-color: gray;  */
        }
		.blist input{
			height: inherit;
		}
        tr,
        td {
            padding: 10px 15px;
        }

        .red {
            color: red;
        }

        .green {
            color: green;
            font-size: 0.8em;
        }

        .right {
            font-size: 0.8em;
            text-align: right;
        }

        textarea {
            width: 99%;
            border: 1px solid silver;
        }

        #submit {
            margin: 30px 0;
            text-align: center;
				}
		center{
			margin-bottom:100px;
		}		
	</style>
	<style>
		.bookred{
			background-color: #ffe6e6;
			border: 1px solid red;
			/* background: #5ee; */
		}
		.bookgreen{
			background-color: #ccffdd;
			border: 1px solid green;
		}
		.bookblue{
			background-color: #e6e6ff;
			border: 1px solid blue;
		}
	</style>

	</head>
	<body>
	<div class="colorlib-loader"></div>

<div id="page">
	<nav class="colorlib-nav" role="navigation">
		<div class="top-menu">
			<div class="container">
				<div class="row">
					<div class="col-xs-2">
						<div id="colorlib-logo"><a href="index.php"><img src="images/logo.png" width="80px" alt=""></a></div>
					</div>
					<div class="col-xs-10 text-right menu-1">
						<ul>
							<li><a href="index.php">Home</a></li>
							<li><a href="rooms.php">Rooms</a></li>
							<li><a href="do.html">Do</a></li>
							<li><a href="tour.php">Tour</a></li>
							<li><a href="info.html">Info</a></li> 
							<li class="active"><a href="#">Reservation</a></li>
							<li><a href="notice.php">Notice</a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</nav>	

		<aside id="colorlib-hero">
			<div class="flexslider">
				<ul class="slides">
			   	<li style="background-image:url(images/01_01.jpg);">
			   		<div class="overlay"></div>
			   		<div class="container-fluid">
			   			<div class="row">
				   			<div class="col-md-6 col-sm-12 col-md-offset-3 slider-text main-text">
				   				<div class="slider-text-inner slider-text-inner2 text-center">
								   <h2>Awesome days !!!</h2>
				   					<h1>Reservation</h1>
				   				</div>
				   			</div>
				   		</div>
			   		</div>
			   	</li>
			  	</ul>
		  	</div>
		</aside>
	

		<div width=100%>	
	    <center>
			<div id="wrap" width=100%>
            <div id="rTopmenu" width=100%>
                <ul id="rList">
					<li>
                        <a href="reservation_guide.php" style="color:grey">예약안내</a>
                    </li>
                    <li>
                        <a href="reservation_status.php" style="color:#fff; background-color:#F96D00;">예약현황</a>
                    </li>
                    <li>
                        <a href="reservation.php" style="color:grey">예약하기</a>
                    </li>
                    <li>
                        <a href="reservation_check.php" style="color:grey">예약확인</a>
                    </li>
                </ul>
            </div>
			</div>	
	
	<!-- <div class="colorlib-loader"></div>
	<div id="page">

		<nav class="colorlib-nav" role="navigation">
			<div class="top">
				<div class="container">
					<div class="row">
						<div class="col-xs-2">
							<div id="colorlib-logo">예약현황</a></div>
						</div>
						<div class="col-xs-10 text-right menu-1">
							<ul>
								<li class="active"><a href="bookdate.php">예약하기</a></li>
								<li><a href="bookstatus.php">예약현황</a></li>
								<li><a href="bookconfirm.php">예약확인</a></li>
							</ul>
						</div>
					</div>
				</div>
			</div>
			<div class="top-menu">
				<div class="container">
				</div>
			</div>
		</nav>-->


		<div id="colorlib-reservation">
			<div class="container">
				<div class="row">
					<div class="col-md-12 search-wrap"> 
					<?
	// 현재 timezone이 설정되어 있지 않은 경우에만 추가
	//date_default_timezone_set('Asia/Seoul');

	$yy = isset($_REQUEST['yy']) ? $_REQUEST['yy'] : date('Y');
	$mm = isset($_REQUEST['mm']) ? $_REQUEST['mm'] : date('m');

	// global $room_name,$room_id;

	include "zdb_mysqli.php";
	$conn = dbconn();
	$query = "select * from room";
	$result = dbquery($conn,$query);
	$roomcount = mysqli_num_rows($result);
	if($roomcount != 0){
		for($i = 0; $i < $roomcount; $i++)
		{
			$row = dbfetch_array($result);
			$room_id[$i] = $row['room_id'];
			$room_name[$i] = $row['room_name'];
		}
	}	

	function sel_yy($yy, $func) {
		if($yy == '') $yy = date('Y');

		if($func=='') {
			$str = "<select name='yy' style='font-size:12pt'>\n<option value=''></option>\n";
		} else {
			$str = "<select name='yy' style='font-size:12pt' onChange='$func'>\n<option value=''></option>\n";
		}
		$gijun = date('Y');
		for($i=$gijun-3;$i<$gijun+3;$i++) {
			if($yy == $i) $str .= "<option value='$i' selected>$i</option>";
			else $str .= "<option value='$i'>$i</option>";
		}
		$str .= "</select>";
		return $str;
	}

	function sel_mm($mm, $func) {
		if($func=='') {
			$str = "<select width='10%' height='30'	name='mm' style='font-size:12pt'>\n";
		} else {
			$str = "<select name='mm' onChange='$func' style='font-size:12pt'>\n";
		}
		for($i=1;$i<13;$i++) {
			if($mm == $i) $str .= "<option value='$i' selected>{$i}</option>";
			else $str .= "<option value='$i'>{$i}</option>";
		}
		$str .= "</select>";
		return $str;
	}

	//해당하는 날짜에 room의 상태를 출력한다
	function get_schedule($conn,$dtstr,$room_name,$room_id) {
		$str="<br>";
		for($i=0; $i<9; $i++){
			$roomno = $room_name[$i];
			$roomid = $room_id[$i];
			$room_slist[$i] = "<a href='reservation.php?date_from=$dtstr&room_id=$roomid' style='color:black'><span class='bookblue'>가 </span>&nbsp &nbsp $roomno</a><br>";
			$room_status[$i] = 4; //4-예약가능 0-입금대기 1-예약완료
		}

		$query = "SELECT *
				FROM reservation
				WHERE book_datefrom <= '$dtstr'
				AND book_dateto > '$dtstr'";
				//ORDER BY frdt, todt";
		//$ret = dbquery($sql) or die(mysql_error());
		$result = dbquery($conn,$query);
		
		$rowcount = mysqli_num_rows($result);
		$roomcount = count($room_id);
		if($rowcount != 0){
			for($i = 0; $i < $rowcount; $i++)
			{
				$row = dbfetch_array($result);
				for($j = 0; $j < $roomcount; $j++)
				{
					if($row['room_id'] == $room_id[$j]){
						if($room_status[$j]==4){ //4-예약가능 0-입금대기 1-예약완료
							if($row['book_status']==1){
								$room_slist[$j] =  "<span class='bookred'>완 </span><span style='color:black'>&nbsp &nbsp $room_name[$j]</span><br>";
								$room_status[$j] = 1;
							}
							// else if($row['book_status']==0){
							else{
								$room_slist[$j] =  "<span class='bookgreen'>대 </span><span style='color:black'>&nbsp &nbsp $room_name[$j]</span><br>";
								$room_status[$j] = 0;
							}
						}
					}
				}
			}
		}	
		for($i=0; $i<9; $i++){
					$str .= $room_slist[$i];
		}
		$str .= "<font style='font-size:8pt;'>";
		$str .= "</font><br>";

		return $str;
	}


	// 1. 총일수
	$last_day = date("t", strtotime($yy."-".$mm."-01"));

	// 2. 시작요일 구하기
	$start_week = date("w", strtotime($yy."-".$mm."-01"));

	// 3. 총 몇 주인지 구하기
	$total_week = ceil(($last_day + $start_week) / 7);

	// 4. 마지막 요일 구하기
	$last_week = date('w', strtotime($yy."-".$mm."-".$last_day));
	?>
	<form name="form" method="get">
		<!-- <center> -->
		<table  cellpadding='0' cellspacing='1' bgcolor="#999999" border="1">
			<tr  style='font-size:18pt' bgcolor="#FFFFFF">
				<td colspan="7" cellpadding='8' cellspacing='10' align="center">
				<span>&nbsp; &nbsp;</span> <span >&nbsp; &nbsp; </span>
				<span><?=sel_yy($yy,'submit();')?>년 <?=sel_mm($mm,'submit();')?>월 예약현황</span></td>
			</tr>
			<tr  style='font-size:12pt' bgcolor="#FFFFFF">
				<td  colspan="7" cellpadding='1' cellspacing='1'  align="right">
					<span style='text-align:right'><?echo "Today : " . date("Y-m-d") ."   ";?></span>
				</td>
			</tr>
			<tr  style='font-size:12pt' bgcolor="#FFFFFF">
				<td  colspan="7" cellpadding='1' cellspacing='1'  align="left">
				<span class="bookred">완</span><span > 예약완료 </span><span>&nbsp; &nbsp;</span>
				<span class="bookgreen">대</span><span > 입금대기 </span><span>&nbsp; &nbsp;</span>
				<span class="bookblue">가</span><span > 예약가능</span>
				</td>
			</tr>
			<p class="category"></p>

			<tr height="10">
				<td width="10%" align="center" bgcolor="#DDDDDD" style="color:red"><b>일</b></td>
				<td width="10%" align="center" bgcolor="#DDDDDD"><b>월</b></td>
				<td width="10%" align="center" bgcolor="#DDDDDD"><b>화</b></td>
				<td width="10%" align="center" bgcolor="#DDDDDD"><b>수</b></td>
				<td width="10%" align="center" bgcolor="#DDDDDD"><b>목</b></td>
				<td width="10%" align="center" bgcolor="#DDDDDD"><b>금</b></td>
				<td width="10%" align="center" bgcolor="#DDDDDD"style="color:blue"><b>토</b></td>
			</tr>

<?
			$today_yy = date('Y');
			$today_mm = date('m');
			// 5. 화면에 표시할 초기값을 1로 설정
			$day=1;

			// 6. 총 주 수에 맞춰서 세로줄 만들기
			for($i=1; $i <= $total_week; $i++){?>
			<tr>
<?
		// 7. 총 가로칸 만들기
			  for ($j=0; $j<7; $j++){
?>
				<td width="10%"  align="left" valign="top" bgcolor="#FFFFFF">
<?
				// 8. 첫번째주이고 시작요일보다 $j가 작거나 마지막주이고 
				//    $j가 마지막 요일보다 크면 표시하지 않아야 하므로
				//    그 반대의 경우 -! 으로 표현-에만 날자를 표시한다.
				if (!(($i == 1 && $j < $start_week) || ($i == $total_week && $j > $last_week))){

				if($j == 0){
					// 9. $j== 0이면 일요일이므로 빨간색
					echo "<font color='#FF0000'><b>";
				}else if($j == 6){
					// 10. $j==6이면 토요일이므로 파란색
					echo "<font color='#0000FF'><b>";
				}else{
					// 11. 그외는 평일이므로 검정색
					echo "<font color='#000000'><b>";
				}

				// 12. 오늘 날짜면 굵은 글씨와 under_bar
				if($today_yy == $yy && $today_mm == $mm && $day == date("j")){
					echo "<b><u>$day</u>";
				}
				else echo $day;
				echo "</b></font> &nbsp;";

				//13. 스케줄 출력

				//str_pad — 문자열을 지정한 길이가 되도록 다른 문자열로 채웁니다
				$mm = str_pad($mm, 2, "0", STR_PAD_LEFT);
				$dd = str_pad($day, 2, "0", STR_PAD_LEFT);
				$dtstr = $yy."-".$mm."-".$dd;
				if($dtstr >= date("Y-m-d")){
					$schstr = get_schedule($conn,$dtstr,$room_name,$room_id);
				}
				else{
					$schstr = "<br>예 약 종 료";
				}
					echo $schstr;
				// 14. 날짜 증가
					$day++;
			}
?>
			</td>
			<?}?>
		</tr>
		<?}?>
	</table> 
</center>
<?		
		dbclose($conn);
?>
</form>	
				</div>
				</div>
			</div>
		</div>



	</div>

		<footer id="colorlib-footer" role="contentinfo">
			<div class="container">
				<div class="row row-pb-md">
					<div class="col-md-3 colorlib-widget">
						<h4>다락골 초록원</h4>
						<!-- <p>Facilis ipsum reprehenderit nemo molestias. Aut cum mollitia reprehenderit. Eos cumque dicta adipisci architecto culpa amet.</p> -->
						<!-- <p>
							<ul class="colorlib-social-icons">
								<li><a href="#"><i class="icon-twitter"></i></a></li>
								<li><a href="#"><i class="icon-facebook"></i></a></li>
								<li><a href="#"><i class="icon-linkedin"></i></a></li>
								<li><a href="#"><i class="icon-dribbble"></i></a></li>
							</ul>
						</p> -->
					</div>
					<div class="col-md-3 colorlib-widget">
						<!-- <h4>Quick Links</h4> -->
						<p>
							<ul class="colorlib-footer-links">
								<!-- <li><a href="#">Accomodation</a></li>
								<li><a href="#">Dining &amp; Bar</a></li>
								<li><a href="#">Restaurants</a></li>
								<li><a href="#">Beach &amp; Resorts</a></li>-->
							</ul>
						</p>
					</div>
					<div class="col-md-3">
						<!-- <h4>Recents Blog Post</h4> -->
						<ul class="colorlib-footer-links">
						<li>주소 : 경북 문경시 농암면 서재로 703번지</li>
						<li>TEL : 054.571.8388</a></li>
							<!-- <li><a href="#">A Definitive Guide to the Best Dining and Drinking Venues in the City</a></li> -->
						</ul>
					</div> 

					<div class="col-md-3 col-md-push-1">
						<!-- <h4>Contact Information</h4> -->
						<ul class="colorlib-footer-links">
							<li><a href="mailto:jsg1039@naver.com">jsg1039@naver.com</a></li>
							<li><a href="./darakgol_admin/admin_index.html">관리자 로그인</a></li>
						</ul>
					</div>
				</div>
				<div class="row">
					<div class="col-md-12 text-center">
						<p>
							<small class="block"><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
							Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | Back-end &#38; front-end 1조(김재연,김주연,박선미,박영주,신재순,장미경)
						</p>
					</div>
				</div>
			</div>
		</footer>
	</div>

	<div class="gototop js-top">
		<a href="#" class="js-gotop"><i class="icon-arrow-up2"></i></a>
	</div>
	</body>


	</body>
</html>

